<!DOCTYPE html>
<html>
    <head>
        <title><%= page.title %></title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="stylesheet" 
            href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" 
            integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" 
            crossorigin="anonymous">
    </head>
    <body>
        
        <%- include("partial/navbar.ejs", { ADD_ENDPOINT: endpoints.ADD_ENDPOINT }) %>

        <% task = tasks[0]; %>

        <div class="container">
            <div class="my-3">
                <form method="POST" action="<%= page.formAction %>" enctype="multipart/form-data">

                    <div class="form-group">
                        <label for="task">Task:</label>
                        <textarea 
                            class="form-control <%= ((errors && (errors.text_long || errors.text_short)) ? 'is-invalid' : '') %>" 
                            id="task" 
                            maxlength="250" 
                            name="task_text"><%= task.task_text %></textarea>
                        <% if (errors && (errors.text_long || errors.text_short)) { %>
                            <small class="text-danger">
                                <% if (errors.text_long) { %>
                                    Task cannot exceed 250 characters.
                                <% } %>

                                <% if (errors.text_short) { %>
                                    Task cannot be empty.
                                <% } %>
                            </small>
                        <% } %>
                    </div>
                    
                    <div class="form-group">
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="task_status" value="OPENED" id="r_OPENED"
                                <% if (task.task_status.value == "OPENED") { %>
                                    checked
                                <% } %>
                            >
                            <label class="form-check-label" for="r_OPENED">Opened</label>
                        </div>

                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="task_status" value="INPROGRESS" id="r_INPROGRESS"
                                <% if (task.task_status.value == "INPROGRESS") { %>
                                    checked
                                <% } %>
                            >
                            <label class="form-check-label" for="r_INPROGRESS">In progress</label>
                        </div>
                        
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="task_status" value="CLOSED" id="r_CLOSED"
                                <% if (task.task_status.value == "CLOSED") { %>
                                    checked
                                <% } %>
                            >
                            <label class="form-check-label" for="r_CLOSED">Closed</label>
                        </div>
                    </div> 

                    <div class="form-group">
                        <label for="estimated_end_at">Estimated end:</label>
                        <input class="form-control" type="text" name="estimated_end_at" value="<%= task.estimated_end_at %>" id="estimated_end_at">
                        <% if (errors && errors.estimated_end_at) { %>
                            <small class="text-danger">
                                Should be a date in 'DD.MM.YYYY' format.
                            </small>
                        <% } %>
                    </div>
                    
                    <div class="form-group">
                        <label for="att_file">Attachment:</label>
                        <input class="form-control-file" type="file" name="att_file" id="att_file">
                    </div>

                    <input type="submit" value="Submit" class="btn btn-primary">
                </form>
            </div>
        </div>
    </body>
</html>